<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="author" content="Foredoomed">
  <meta name="generator" content="jekyll">
  <meta name="description" content="The homepage of Zhixingheyi">
  <link href="favicon.ico" rel="icon" type="image/x-icon" />
  <link rel="stylesheet" href="/css/highlight.css" type="text/css">
  <title></title>
</head>

<body>

<div style="width:700px">
  <h1>浏览器是如何工作的(二)</h1>

<em>By Foredoomed on <time date="2011-12-07 22:18:00 +0800">December  7, 2011</time></em>

<h2 id="section">2 渲染引擎</h2>

<p>渲染引擎要做的就是渲染，也就是在浏览器的窗体里显示请求的内容。</p>

<p>一般情况下，渲染引擎可以显示HTML,XML和图片。它也可以通过插件的方式显示其他类型类型的文件，比如PDF。但是，在这章中我们将把焦点放在主要的用例上：显示由CSS格式化过的HTML和图片。</p>

<h3 id="section-1">2.1 多种渲染引擎</h3>

<p>我们作为参考的浏览器：Firefox, Chrome和Safari是构建在不同的两个渲染引擎之上的。Firefox使用的是Gecko，而Chrome和Safari使用的都是Webkit。</p>

<p>Webkit是开源的渲染引擎，它开始时只是针对Linux平台，后来由苹果公司修改后以兼容Mac和Windows平台。<a href="http://webkit.org" title="webkit.org">webkit.org</a>上有更详细的介绍。</p>

<h3 id="section-2">2.2 渲染的主要流程</h3>

<p>渲染引擎是从网络层中获取请求的内容。然后是渲染的基本流程：</p>

<p><img src="http://i1256.photobucket.com/albums/ii494/Foredoomed/flow_zps833bd91a.png" alt="flow" title="flow" /></p>

<p>渲染引擎会开始解析HTML文档，并且把HTML标签转换成为被称作“内容树(content tree)”的DOM节点。还会解析不管是外部引用的还是内联的CSS。样式和可视指令(visual instructions)一起会被创建成为另一棵树-渲染树(render tree)。</p>

<p>在渲染树构造完毕后，浏览器就会开始处理布局。也就是说会分配给每个节点一个屏幕上准确位置的坐标。下一步就是绘制了，即使用UI后端(UI backend)来绘制渲染树每个节点。</p>

<p>理解这是个渐进的过程是非常重要的。为了更好的用户体验，渲染引擎会尽可能快的把内容显示在屏幕上。直到所有的HTML已经解析完毕，并且开始构造和布局渲染树之前，渲染引擎是不会停下等待的。部分的内容会被解析和显示，而在这个时候渲染引擎会继续处理从网络上返回的内容。</p>

<h3 id="section-3">2.3 主要流程实例</h3>

<p><img src="http://i1256.photobucket.com/albums/ii494/Foredoomed/webkitflow_zpsca40fa56.png" alt="webkitflow" title="webkitflow" /></p>

<p><img src="http://i1256.photobucket.com/albums/ii494/Foredoomed/pagespeed_zps5b97199c.jpg" alt="Geckoflow" title="Geckoflow" /></p>

<p>从上两张图山可以看到，尽管Webkit和Gecko使用不同的术语，但是整个流程是基本一样的。</p>

<p>在Gecko里，把已经经过视觉格式化过的元素树称为框架树(frame tree)。每个元素是一个框架。Webkit则用了另外一个术语：由渲染对象(render object)组成的渲染树(render tree)。</p>

<p>Webkit把元素的放置称为布局(layout)，而Gecko则称之为回流(reflow)。附件(attachment)是Webkit用来表示连接DOM节点和视觉信息来创建渲染树的过程。一个细小的，非语意上的区别是，Gecko在HTML和DOM之间又另外多出来一层。它被称为内容下沉层(content sink)，并且它是制造DOM元素的工厂。下面将会说明整个流程的各个部分。</p>



<br><br>

<div id="disqus_thread" style="width:700px"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'zhixingheyi'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<hr>

Zhixingheyi - <a href="http://liuxuan.info">http://liuxuan.info/</a>
</div>

<script src="/javascript/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17293168-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
  var sc_project=8495631;
  var sc_invisible=1;
  var sc_security="5b0817e1";
  var scJsHost = (("https:" == document.location.protocol) ?
  "https://secure." : "http://www.");
  document.write("<sc"+"ript type='text/javascript' src='" +
  scJsHost +
  "statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript>
  <div class="statcounter"><a title="website
  statistics" href="http://statcounter.com/"
  target="_blank"><img class="statcounter"
  src="https://c.statcounter.com/8495631/0/5b0817e1/1/"
  alt="website statistics"></a></div>
</noscript>
<!-- End of StatCounter Code for Default Guide -->

</body>
</html>